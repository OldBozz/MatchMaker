@using MatchMakerLib.MatchMakerModel;
@using MatchMakerPro.Data;

@inject MatchMakerDbContext dbcontext
@inject Club activeclub

@inherits LayoutComponentBase
@*<MudThemeProvider Theme="MatchMakerTheme"/>
*@
<MudThemeProvider Theme="_themeManager.Theme" />
@*<MudAppBar Elevation="_themeManager.AppBarElevation"></MudAppBar>*@
<MudDialogProvider BackdropClick="false" />
<MudSnackbarProvider />
<MudPopoverProvider />

<MudLayout>



    <MudAppBar Fixed="false" Elevation="20">
        <MudIconButton Href="/" Icon="@Icons.Material.Filled.SportsVolleyball" Color="MudBlazor.Color.Inherit" Edge="Edge.Start" />
        <MudText Typo="Typo.h4" Class="mx-10" Align="MudBlazor.Align.Left">MatchMakerPro</MudText>
@*        <MudThemeManagerButton OnClick="@((e) => OpenThemeManager(true))" />
        <MudThemeManager Open="_themeManagerOpen" OpenChanged="OpenThemeManager" Theme="_themeManager" ThemeChanged="UpdateTheme" />
*@        @*<MudSpacer />*@
        <MudMenu Color="MudBlazor.Color.Inherit" Dense="true" ActivationEvent="@MouseEvent.LeftClick" AnchorOrigin="Origin.BottomCenter" TransformOrigin="Origin.TopCenter">
            <ActivatorContent>
                <MudChip T="string" Icon="@Icons.Material.Filled.AddChart" Color="MudBlazor.Color.Primary">Tournament</MudChip>
            </ActivatorContent>
            <ChildContent>
                <MudMenuItem Href="/">Dashboard</MudMenuItem>
                <MudMenuItem Href="/CreateTournament">Create new</MudMenuItem>
            </ChildContent>
        </MudMenu>
        <MudMenu Color="MudBlazor.Color.Inherit" Dense="true" ActivationEvent="@MouseEvent.LeftClick" AnchorOrigin="Origin.BottomCenter" TransformOrigin="Origin.TopCenter">
            <ActivatorContent>
                <MudChip T="string" Icon="@Icons.Material.Filled.AttachMoney" Color="MudBlazor.Color.Primary">Betting</MudChip>
            </ActivatorContent>
            <ChildContent>
                <MudMenuItem Href="/Betplace">Place bet</MudMenuItem>
                <MudMenuItem Href="/Betresults">Results</MudMenuItem>
            </ChildContent>
        </MudMenu>
        <MudMenu Icon="@Icons.Material.Outlined.AddCard" Dense="true" Color="MudBlazor.Color.Inherit" ActivationEvent="@MouseEvent.LeftClick" AnchorOrigin="Origin.BottomCenter" TransformOrigin="Origin.TopCenter">
            <ActivatorContent>
                <MudChip T="string" Icon="@Icons.Material.Filled.AddCard" Color="MudBlazor.Color.Primary">Data</MudChip>
            </ActivatorContent>
            <ChildContent>
                <MudMenuItem Href="/Ranking">Rankings</MudMenuItem>
                <MudMenuItem Href="/Clubs">Clubs</MudMenuItem>
                <MudMenuItem Href="/Mainevents">Main events</MudMenuItem>
                <MudMenuItem Href="/Players">Players</MudMenuItem>
                @*               <MudMenuItem Href="/Teams">Teams</MudMenuItem>
                <MudMenuItem Href="/Matches">Matches</MudMenuItem>
                *@                <MudMenuItem Href="/Courts">Courts</MudMenuItem>
                <MudMenuItem Href="/Tournaments">Tournaments</MudMenuItem>
                @*<MudMenuItem Href="/Import-Export">Import/Export</MudMenuItem>*@
            </ChildContent>
        </MudMenu>
        <MudMenu Icon="@Icons.Material.Sharp.AutoGraph" Dense="true" Color="MudBlazor.Color.Inherit" ActivationEvent="@MouseEvent.LeftClick" AnchorOrigin="Origin.BottomCenter" TransformOrigin="Origin.TopCenter">
            <ActivatorContent>
                <MudChip T="string" Icon="@Icons.Material.Sharp.AutoGraph" Color="MudBlazor.Color.Primary">Statistics</MudChip>
            </ActivatorContent>
            <ChildContent>
                <MudMenuItem Href="/RankingChart">Ranking</MudMenuItem>
                <MudMenuItem Href="/PlayersChart">Players</MudMenuItem>
@*                <MudMenuItem Href="/Teamsstat">Teams</MudMenuItem>
                <MudMenuItem Href="/Matchesstat">Matches</MudMenuItem>
*@            </ChildContent>
        </MudMenu>
        <MudSpacer />
        <MudText Typo="Typo.subtitle1" Class="mr-1">Active Club: @activeclub</MudText>
        <MudIconButton Icon="@Icons.Material.TwoTone.ChangeCircle" Color="MudBlazor.Color.Inherit" OnClick="SelectActiveClub" />

        @*       <MudSelect T="Club" Dense="true" Class="ml-4" MultiSelection="false" Value="activeclub">
        @foreach (Club club in dbcontext.Clubs)
        {
        <MudSelectItem T="Club" Value="@club" />
        }
        </MudSelect>
        *@@*        <LoginDisplay />
        *@
    </MudAppBar>
    <MudMainContent>
        <MudContainer MaxWidth="MaxWidth.False" Class="my-1 pt-1">
            @Body
        </MudContainer>
    </MudMainContent>
</MudLayout>



@code {
    MudTheme MatchMakerTheme = new MudTheme()
        {
            PaletteLight = new PaletteLight()
            {
                Primary = Colors.Blue.Default,
                Secondary = Colors.Green.Accent4,
                AppbarBackground = Colors.Yellow.Default,
                AppbarText = Colors.Blue.Default
            },
            PaletteDark = new PaletteDark()
            {
                Primary = Colors.Blue.Lighten1
            }

        };
    private ThemeManagerTheme _themeManager = new ThemeManagerTheme();
    public bool _themeManagerOpen = false;


    void OpenThemeManager(bool value)
    {
        _themeManagerOpen = value;
    }

    void UpdateTheme(ThemeManagerTheme value)
    {
        _themeManager = value;
        StateHasChanged();
    }

    protected override void OnInitialized()
    {
        if (dbcontext.Clubs.Count() > 0)
            activeclub = dbcontext.Clubs.First();
        _themeManager.Theme.PaletteLight = new PaletteLight()
            {
                Primary = Colors.Blue.Default,
                Secondary = Colors.Green.Accent4,
                AppbarBackground = Colors.Yellow.Default,
                AppbarText = Colors.Blue.Default
            };
        _themeManager.Theme.PaletteDark = new PaletteDark()
            {
                Primary = Colors.Blue.Lighten1
            };
        StateHasChanged();
    }
    void SelectActiveClub()
    {

    }

}